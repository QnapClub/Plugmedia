var PM={growlNotification:function(a,b,c){$.Growl.show({title:c,message:b,icon:a,timeout:5000})},loadingPage:function(b){if(typeof(check_indexing)!=="undefined"){clearInterval(check_indexing)}var a=b;PM.createLoadingModalWin();$.ajax({dataType:"json",url:a,cache:true,success:function(c){PM.updatePagePart(c)},error:function(){PM.redirectToIndex();return false},complete:function(){},beforeSend:function(){}})},updatePagePart:function(a){jQuery.each(a,function(c,b){$("#"+c).html(b).fadeTo(300,1)});$.modal.close();PM.createGridList();PM.refreshjBreadCrumb();PM.resetButtonBubblePopup();PM.button_list();$("#inner_center_demo").scrollTop(0)},resetButtonBubblePopup:function(){$("#button_thumb > .ui-button-text").RemoveBubblePopup();$("#button_thumb_list> .ui-button-text").RemoveBubblePopup();$("#button_list> .ui-button-text").RemoveBubblePopup();$("#button_slideshow > .ui-button-text").RemoveBubblePopup();$("#button_cooliris> .ui-button-text").RemoveBubblePopup();$("#button_radio> .ui-button-text").RemoveBubblePopup();$("#button_watchdir_subscribe > .ui-button-text").RemoveBubblePopup();$("#button_watchdir> .ui-button-text").RemoveBubblePopup()},redirectToIndex:function(){window.location.href="index.php"},createLoadingModalWin:function(){$("#osx-modal-content").modal({overlayId:"osx-overlay",containerId:"osx-container",closeHTML:null,minHeight:80,opacity:40,position:["0",],overlayClose:true,close:false,overlayClose:false,modal:false,onOpen:function(a){PM.openModalLoading(a)},onClose:function(a){PM.closeModalLoading(a)}})},openModalLoading:function(b){var a=this;a.container=b.container[0];b.overlay.fadeIn("slow",function(){$("#osx-modal-content",a.container).show();var c=$("#osx-modal-title",a.container);c.show();b.container.slideDown("fast",function(){setTimeout(function(){var d=$("#osx-modal-data",a.container).height()+c.height()+20;b.container.animate({height:d},100,function(){})},50)})})},closeModalLoading:function(a){$.modal.close()},createGridList:function(){default_val=PM.refreshGridList();PM.addGridSlider(default_val)},refreshGridList:function(){var a=$.cookie("pm_slider_size");if(typeof(a)=="undefined"||a==null){a="30"}$("ul.grid li").css("font-size",a+"px");return a},addGridSlider:function(a){$("#grid_slider").slider({value:a,max:40,min:20,animate:"fast",slide:function(b,c){$("ul.grid li").css("font-size",c.value+"px");$.cookie("pm_slider_size",c.value,{expires:365})}})},refreshjBreadCrumb:function(){jQuery("#breadCrumb0").jBreadCrumb()},addTree:function(){$("#pm_tree").jstree({plugins:["themes","json_data","ui","cookies","types","contextmenu"],themes:{theme:"classic",url:PM_config.url_css+"/tree_style.css",dots:true},json_data:{ajax:{url:"./api.php?ac=getalloweddir&disp=json",type:"POST",data:function(a){return{node:a.attr?a.attr("id").replace("node_",""):"getroot_node"}}}},contextmenu:{items:{create:false,rename:false,remove:false,ccp:false,add_playlist:{label:"Add all items to playlist",action:function(a){alert(a)}},create_root:{label:"Assign thumbnail",action:function(a){alert(a)}}}},cookies:{save_opened:"jstree_open",save_selected:false},types:{max_depth:-2,max_children:-2,valid_children:["drive"],types:{"default":{valid_children:"none",icon:{image:PM_config.url_img+"/tree/file.png"}},folder:{valid_children:["default","folder"],icon:{image:PM_config.url_img+"/tree/folder.gif"}},drive:{valid_children:["default","folder"],icon:{image:PM_config.url_img+"/tree/server.png"},start_drag:false,move_node:false,delete_node:false,remove:false}}},core:{animation:200,initially_open:["root"]}})},lauch_login_windows:function(){$("#basic-modal-content").modal({containerCss:{height:200,width:400},onOpen:function(a){a.overlay.fadeIn("fast");a.container.fadeIn("fast",function(){a.data.fadeIn("slow")})}});return false},watch_dir:function(a){a.children(":first").removeClass("icon_watchdir");a.children(":first").addClass("icon_wait");$.ajax({dataType:"json",url:"api.php?ac=addfollower&"+a.attr("value"),cache:false,success:function(b){if(b.success){a.children(":first").removeClass("icon_wait").addClass("icon_watchdir_ok")}},error:function(){a.children(":first").removeClass("icon_wait").addClass("icon_watchdir")},})},watch_dir_register:function(a){a.children(":first").removeClass("icon_watchdir_ok");a.children(":first").addClass("icon_wait");$.ajax({dataType:"json",url:"api.php?ac=removefollower&"+a.attr("value"),cache:false,success:function(b){if(b.success){a.children(":first").removeClass("icon_wait").addClass("icon_watchdir")}},error:function(){a.children(":first").removeClass("icon_wait").addClass("icon_watchdir_ok")},})},supportKeyboard:function(){$(document).keydown(function(a){switch(a.keyCode){case 37:if($("#left_link").length>0){PM.loadingPage($("#left_link").attr("href"))}break;case 39:if($("#right_link").length>0){PM.loadingPage($("#right_link").attr("href"))}break}})},button_list:function(){$("#button_watchdir").button({text:false,icons:{primary:"icon_watchdir"}}).toggle(function(){PM.watch_dir($("#button_watchdir"))},function(){PM.watch_dir_register($("#button_watchdir"))});$("#button_watchdir_subscribe").button({text:false,icons:{primary:"icon_watchdir_ok"}}).toggle(function(){PM.watch_dir_register($("#button_watchdir_subscribe"))},function(){PM.watch_dir($("#button_watchdir_subscribe"))});$("#button_radio").button({text:false,icons:{primary:"icon_radio"}}).bind("click",function(){window.open($(this).attr("value"));return false});$("#button_thumb").button({text:false,icons:{primary:"icon_thumb"}}).bind("click",function(){PM.resetButtonBubblePopup()});$("#button_thumb_list").button({text:false,icons:{primary:"icon_thumb_list"}}).bind("click",function(){PM.resetButtonBubblePopup()});$("#button_list").button({text:false,icons:{primary:"icon_list"}}).bind("click",function(){PM.resetButtonBubblePopup()});$("#button_slideshow").button({text:false,icons:{primary:"icon_slideshow"}}).bind("click",function(){window.open($(this).attr("value"));return false});$("#button_cooliris").button({text:false,icons:{primary:"icon_cooliris"}}).bind("click",function(){PicLensLite.start({feedUrl:$(this).attr("value")})});if(!$("#button_thumb > .ui-button-text").HasBubblePopup()){$("#button_thumb > .ui-button-text").CreateBubblePopup({innerHtml:$("#button_thumb").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_thumb_list> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_thumb_list").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_list> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_list").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_slideshow> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_slideshow").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_cooliris> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_cooliris").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_radio> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_radio").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_watchdir_subscribe> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_watchdir_subscribe").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"});$("#button_watchdir> .ui-button-text").CreateBubblePopup({innerHtml:$("#button_watchdir").attr("ref"),themePath:PM_config.url_img+"/bubble_theme",themeName:"all-black"})}},enableSearchForm:function(){$("#search_form").ajaxForm({dataType:"json",beforeSubmit:function(){$("#search_loading").fadeIn("slow")},success:function(b,c,d,a){$("#search_loading").fadeOut();PM.updatePagePart(b)}})},init:function(){PM.refreshjBreadCrumb();PM.createGridList();PM.addTree();PM_toolbar.init();PM.button_list();PM.supportKeyboard();PM.enableSearchForm();var a,b;a=$("body").layout(layoutSettings_Outer);var e="body > .ui-layout-west";$("<span></span>").addClass("pin-button").prependTo(e);a.addPinBtn(e+" .pin-button","west");$("<span></span>").attr("id","west-closer").prependTo(e);a.addCloseBtn("#west-closer","west");b=$(a.options.center.paneSelector).layout(layoutSettings_Inner);$("#loading").fadeOut("slow");$("#loading-mask").fadeOut("slow");$("input.[name='login_reset']").click(function(){$.modal.close()});$("#login_form").ajaxForm({dataType:"json",success:c,beforeSubmit:function(k,j,g){$("#result").hide();for(var h=0;h<k.length;h++){if(!k[h].value){$("#result > p").html(PM_config.lang_fillinfield);$("#result").fadeIn("slow");return false}}f()}});function f(){$("#login_loading").fadeIn("slow")}function d(){$("#login_loading").fadeOut()}function c(g){if(!g){d();$("#result > p").html(PM_config.lang_errorlogin);$("#result").fadeIn("slow")}else{window.location.reload()}}$(".custom_target").live("click",function(){PM.loadingPage($(this).attr("href"));return false})}};jQuery(function(b){var a={container:null,init:function(){b("input.osx, a.osx").click(function(c){c.preventDefault();b("#osx-modal-content").modal({overlayId:"osx-overlay",containerId:"osx-container",closeHTML:null,minHeight:80,opacity:65,position:["0",],overlayClose:true,onOpen:a.open,onClose:a.close})})},open:function(e){var c=this;c.container=e.container[0];e.overlay.fadeIn("slow",function(){b("#osx-modal-content",c.container).show();var d=b("#osx-modal-title",c.container);d.show();e.container.slideDown("slow",function(){setTimeout(function(){var f=b("#osx-modal-data",c.container).height()+d.height()+20;e.container.animate({height:f},200,function(){b("div.close",c.container).show();b("#osx-modal-data",c.container).show()})},300)})})},close:function(e){var c=this;e.container.animate({top:"-"+(e.container.height()+20)},500,function(){c.close()})}};a.init()});var layoutSettings_Inner={north:{spacing_open:0,togglerLength_open:0,togglerLength_closed:-1,size:27,resizable:false,showOverflowOnHover:true,slidable:false,fxName:"none"}};var layoutSettings_Outer={name:"outerLayout",defaults:{useStateCookie:true,paneClass:"pane",resizerClass:"resizer",togglerClass:"toggler",buttonClass:"button",contentSelector:".content",contentIgnoreSelector:"span",togglerLength_open:35,togglerLength_closed:35,togglerTip_open:"Close This Pane",togglerTip_closed:"Open This Pane",resizerTip:"Resize This Pane",fxName:"slide",fxSpeed_open:750,fxSpeed_close:1500,fxSettings_open:{easing:"easeInQuint"},fxSettings_close:{easing:"easeOutBounce"}},north:{spacing_open:0,size:97,togglerLength_open:0,togglerLength_closed:-1,resizable:false,slidable:false,fxName:"none"},south:{size:35,spacing_closed:0,togglerLength_open:0,slidable:false,resizable:false,spacing_open:0},west:{size:250,spacing_closed:5,togglerLength_closed:21,spacing_open:5,togglerAlign_closed:"center middle",togglerLength_open:40,togglerTip_open:"Close West Pane",togglerTip_closed:"Open West Pane",resizerTip_open:"Resize West Pane",slideTrigger_open:"click",initClosed:false},center:{paneSelector:"#mainContent",onresize:"innerLayout.resizeAll",minWidth:200,minHeight:200}};